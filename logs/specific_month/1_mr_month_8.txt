Args in experiment:
Namespace(is_training=1, model_id='test', model='iTransformer', data='custom', root_path='./target_data/specific_month', data_path='1_mr_month_8_data.csv', features='MS', target='WaterTemperature', freq='h', checkpoints='./checkpoints/', seq_len=731, label_len=731, pred_len=24, enc_in=7, dec_in=7, c_out=1, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='August 1 Year Range', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=True, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
>>>>>>>start training : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtAugust 1 Year Range_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11258
val 1693
test 3409
	iters: 100, epoch: 1 | loss: 0.0416778
	speed: 0.0246s/iter; left time: 83.9886s
	iters: 200, epoch: 1 | loss: 0.0535368
	speed: 0.0189s/iter; left time: 62.5064s
	iters: 300, epoch: 1 | loss: 0.0280953
	speed: 0.0181s/iter; left time: 58.1215s
Epoch: 1 cost time: 7.081356048583984
Epoch: 1, Steps: 351 | Train Loss: 0.0436949 Vali Loss: 0.0087001 Test Loss: 0.0157441
Validation loss decreased (inf --> 0.008700).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0198665
	speed: 0.2673s/iter; left time: 817.8848s
	iters: 200, epoch: 2 | loss: 0.0159066
	speed: 0.0181s/iter; left time: 53.6061s
	iters: 300, epoch: 2 | loss: 0.0115507
	speed: 0.0182s/iter; left time: 52.0636s
Epoch: 2 cost time: 6.660846948623657
Epoch: 2, Steps: 351 | Train Loss: 0.0162838 Vali Loss: 0.0070252 Test Loss: 0.0149984
Validation loss decreased (0.008700 --> 0.007025).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0092922
	speed: 0.2681s/iter; left time: 726.1903s
	iters: 200, epoch: 3 | loss: 0.0085726
	speed: 0.0182s/iter; left time: 47.5365s
	iters: 300, epoch: 3 | loss: 0.0233934
	speed: 0.0183s/iter; left time: 45.8458s
Epoch: 3 cost time: 6.598457336425781
Epoch: 3, Steps: 351 | Train Loss: 0.0106745 Vali Loss: 0.0058054 Test Loss: 0.0131309
Validation loss decreased (0.007025 --> 0.005805).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0098897
	speed: 0.2701s/iter; left time: 636.8800s
	iters: 200, epoch: 4 | loss: 0.0065349
	speed: 0.0185s/iter; left time: 41.7326s
	iters: 300, epoch: 4 | loss: 0.0061471
	speed: 0.0185s/iter; left time: 39.9109s
Epoch: 4 cost time: 6.723292589187622
Epoch: 4, Steps: 351 | Train Loss: 0.0090994 Vali Loss: 0.0056079 Test Loss: 0.0124563
Validation loss decreased (0.005805 --> 0.005608).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0056486
	speed: 0.2700s/iter; left time: 541.9445s
	iters: 200, epoch: 5 | loss: 0.0084435
	speed: 0.0195s/iter; left time: 37.1894s
	iters: 300, epoch: 5 | loss: 0.0108662
	speed: 0.0184s/iter; left time: 33.3209s
Epoch: 5 cost time: 6.830449104309082
Epoch: 5, Steps: 351 | Train Loss: 0.0083495 Vali Loss: 0.0054308 Test Loss: 0.0124324
Validation loss decreased (0.005608 --> 0.005431).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0067411
	speed: 0.2759s/iter; left time: 456.8270s
	iters: 200, epoch: 6 | loss: 0.0073450
	speed: 0.0184s/iter; left time: 28.7009s
	iters: 300, epoch: 6 | loss: 0.0072476
	speed: 0.0192s/iter; left time: 27.9645s
Epoch: 6 cost time: 6.829255819320679
Epoch: 6, Steps: 351 | Train Loss: 0.0080065 Vali Loss: 0.0052997 Test Loss: 0.0122592
Validation loss decreased (0.005431 --> 0.005300).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0052496
	speed: 0.2673s/iter; left time: 348.7958s
	iters: 200, epoch: 7 | loss: 0.0050721
	speed: 0.0179s/iter; left time: 21.5203s
	iters: 300, epoch: 7 | loss: 0.0076904
	speed: 0.0183s/iter; left time: 20.2076s
Epoch: 7 cost time: 6.530715465545654
Epoch: 7, Steps: 351 | Train Loss: 0.0077933 Vali Loss: 0.0052402 Test Loss: 0.0122443
Validation loss decreased (0.005300 --> 0.005240).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0078819
	speed: 0.2661s/iter; left time: 253.8195s
	iters: 200, epoch: 8 | loss: 0.0076212
	speed: 0.0182s/iter; left time: 15.5436s
	iters: 300, epoch: 8 | loss: 0.0053995
	speed: 0.0184s/iter; left time: 13.8389s
Epoch: 8 cost time: 6.8684000968933105
Epoch: 8, Steps: 351 | Train Loss: 0.0077088 Vali Loss: 0.0052788 Test Loss: 0.0122133
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0078487
	speed: 0.2769s/iter; left time: 166.9428s
	iters: 200, epoch: 9 | loss: 0.0068021
	speed: 0.0179s/iter; left time: 9.0044s
	iters: 300, epoch: 9 | loss: 0.0061835
	speed: 0.0177s/iter; left time: 7.1499s
Epoch: 9 cost time: 6.481323480606079
Epoch: 9, Steps: 351 | Train Loss: 0.0077155 Vali Loss: 0.0052512 Test Loss: 0.0121922
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0073137
	speed: 0.2630s/iter; left time: 66.2732s
	iters: 200, epoch: 10 | loss: 0.0059572
	speed: 0.0186s/iter; left time: 2.8237s
	iters: 300, epoch: 10 | loss: 0.0067910
	speed: 0.0183s/iter; left time: 0.9503s
Epoch: 10 cost time: 6.633151292800903
Epoch: 10, Steps: 351 | Train Loss: 0.0076197 Vali Loss: 0.0052226 Test Loss: 0.0121920
Validation loss decreased (0.005240 --> 0.005223).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtAugust 1 Year Range_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3409
test shape: (3409, 1, 24, 1) (3409, 1, 24, 1)
test shape: (3409, 24, 1) (3409, 24, 1)
mse:0.35586005449295044, mae:0.455170601606369, rmse:0.596540093421936, mape:0.034751325845718384, mspe:0.002036505378782749
>>>>>>>predicting : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtAugust 1 Year Range_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
pred 1
