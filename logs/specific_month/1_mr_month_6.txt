Args in experiment:
Namespace(is_training=1, model_id='test', model='iTransformer', data='custom', root_path='./target_data/specific_month', data_path='1_mr_month_6_data.csv', features='MS', target='WaterTemperature', freq='h', checkpoints='./checkpoints/', seq_len=731, label_len=731, pred_len=24, enc_in=7, dec_in=7, c_out=1, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='June 1 Year Range', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=True, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
>>>>>>>start training : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtJune 1 Year Range_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10888
val 1641
test 3303
	iters: 100, epoch: 1 | loss: 0.0455644
	speed: 0.0249s/iter; left time: 82.1058s
	iters: 200, epoch: 1 | loss: 0.0333789
	speed: 0.0180s/iter; left time: 57.6420s
	iters: 300, epoch: 1 | loss: 0.0571257
	speed: 0.0181s/iter; left time: 56.1546s
Epoch: 1 cost time: 6.849865674972534
Epoch: 1, Steps: 340 | Train Loss: 0.0452352 Vali Loss: 0.0096750 Test Loss: 0.0088537
Validation loss decreased (inf --> 0.009675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0221857
	speed: 0.2576s/iter; left time: 762.6594s
	iters: 200, epoch: 2 | loss: 0.0089917
	speed: 0.0184s/iter; left time: 52.7414s
	iters: 300, epoch: 2 | loss: 0.0127680
	speed: 0.0186s/iter; left time: 51.3258s
Epoch: 2 cost time: 6.43835973739624
Epoch: 2, Steps: 340 | Train Loss: 0.0164208 Vali Loss: 0.0064658 Test Loss: 0.0068050
Validation loss decreased (0.009675 --> 0.006466).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0097435
	speed: 0.2592s/iter; left time: 679.3235s
	iters: 200, epoch: 3 | loss: 0.0095494
	speed: 0.0188s/iter; left time: 47.3683s
	iters: 300, epoch: 3 | loss: 0.0073373
	speed: 0.0181s/iter; left time: 43.9131s
Epoch: 3 cost time: 6.418998956680298
Epoch: 3, Steps: 340 | Train Loss: 0.0107719 Vali Loss: 0.0058310 Test Loss: 0.0068204
Validation loss decreased (0.006466 --> 0.005831).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0080066
	speed: 0.2574s/iter; left time: 587.0780s
	iters: 200, epoch: 4 | loss: 0.0061754
	speed: 0.0180s/iter; left time: 39.2157s
	iters: 300, epoch: 4 | loss: 0.0220212
	speed: 0.0180s/iter; left time: 37.3982s
Epoch: 4 cost time: 6.328139305114746
Epoch: 4, Steps: 340 | Train Loss: 0.0090159 Vali Loss: 0.0053832 Test Loss: 0.0064237
Validation loss decreased (0.005831 --> 0.005383).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0105481
	speed: 0.2565s/iter; left time: 497.9503s
	iters: 200, epoch: 5 | loss: 0.0066989
	speed: 0.0178s/iter; left time: 32.7792s
	iters: 300, epoch: 5 | loss: 0.0080601
	speed: 0.0179s/iter; left time: 31.1262s
Epoch: 5 cost time: 6.333192348480225
Epoch: 5, Steps: 340 | Train Loss: 0.0083538 Vali Loss: 0.0053831 Test Loss: 0.0065697
Validation loss decreased (0.005383 --> 0.005383).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0238312
	speed: 0.2650s/iter; left time: 424.3101s
	iters: 200, epoch: 6 | loss: 0.0053706
	speed: 0.0181s/iter; left time: 27.2244s
	iters: 300, epoch: 6 | loss: 0.0052142
	speed: 0.0184s/iter; left time: 25.8036s
Epoch: 6 cost time: 6.3839874267578125
Epoch: 6, Steps: 340 | Train Loss: 0.0079434 Vali Loss: 0.0052518 Test Loss: 0.0064254
Validation loss decreased (0.005383 --> 0.005252).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0072478
	speed: 0.2578s/iter; left time: 325.1129s
	iters: 200, epoch: 7 | loss: 0.0058800
	speed: 0.0181s/iter; left time: 20.9710s
	iters: 300, epoch: 7 | loss: 0.0037443
	speed: 0.0186s/iter; left time: 19.7670s
Epoch: 7 cost time: 6.384936571121216
Epoch: 7, Steps: 340 | Train Loss: 0.0076800 Vali Loss: 0.0051682 Test Loss: 0.0063963
Validation loss decreased (0.005252 --> 0.005168).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0066650
	speed: 0.2597s/iter; left time: 239.1706s
	iters: 200, epoch: 8 | loss: 0.0166241
	speed: 0.0188s/iter; left time: 15.4354s
	iters: 300, epoch: 8 | loss: 0.0076069
	speed: 0.0186s/iter; left time: 13.4023s
Epoch: 8 cost time: 6.485367774963379
Epoch: 8, Steps: 340 | Train Loss: 0.0076788 Vali Loss: 0.0051560 Test Loss: 0.0064123
Validation loss decreased (0.005168 --> 0.005156).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0053569
	speed: 0.2708s/iter; left time: 157.3353s
	iters: 200, epoch: 9 | loss: 0.0051526
	speed: 0.0185s/iter; left time: 8.9161s
	iters: 300, epoch: 9 | loss: 0.0069485
	speed: 0.0183s/iter; left time: 6.9900s
Epoch: 9 cost time: 6.513080358505249
Epoch: 9, Steps: 340 | Train Loss: 0.0076340 Vali Loss: 0.0051580 Test Loss: 0.0064151
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0058325
	speed: 0.2580s/iter; left time: 62.1780s
	iters: 200, epoch: 10 | loss: 0.0067080
	speed: 0.0179s/iter; left time: 2.5185s
	iters: 300, epoch: 10 | loss: 0.0070633
	speed: 0.0182s/iter; left time: 0.7459s
Epoch: 10 cost time: 6.386093854904175
Epoch: 10, Steps: 340 | Train Loss: 0.0075856 Vali Loss: 0.0051905 Test Loss: 0.0064071
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtJune 1 Year Range_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3303
test shape: (3303, 1, 24, 1) (3303, 1, 24, 1)
test shape: (3303, 24, 1) (3303, 24, 1)
mse:0.19756019115447998, mae:0.3463042974472046, rmse:0.4444774389266968, mape:0.03132269158959389, mspe:0.0016572155291214585
>>>>>>>predicting : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtJune 1 Year Range_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
pred 1
