Args in experiment:
Namespace(is_training=1, model_id='test', model='iTransformer', data='custom', root_path='./target_data', data_path='data_test_4.csv', features='MS', target='WaterTemperature', freq='h', checkpoints='./checkpoints/', seq_len=731, label_len=731, pred_len=24, enc_in=7, dec_in=7, c_out=1, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=True, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=True, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
>>>>>>>start training : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141486
val 20298
test 40617
	iters: 100, epoch: 1 | loss: 0.0113897
	speed: 0.0357s/iter; left time: 1576.2651s
	iters: 200, epoch: 1 | loss: 0.0084987
	speed: 0.0174s/iter; left time: 763.9143s
	iters: 300, epoch: 1 | loss: 0.0051631
	speed: 0.0157s/iter; left time: 687.3240s
	iters: 400, epoch: 1 | loss: 0.0035775
	speed: 0.0168s/iter; left time: 737.1339s
	iters: 500, epoch: 1 | loss: 0.0067768
	speed: 0.0169s/iter; left time: 738.8676s
	iters: 600, epoch: 1 | loss: 0.0080007
	speed: 0.0175s/iter; left time: 763.7871s
	iters: 700, epoch: 1 | loss: 0.0059223
	speed: 0.0177s/iter; left time: 770.0918s
	iters: 800, epoch: 1 | loss: 0.0037475
	speed: 0.0160s/iter; left time: 696.1197s
	iters: 900, epoch: 1 | loss: 0.0038297
	speed: 0.0162s/iter; left time: 702.7014s
	iters: 1000, epoch: 1 | loss: 0.0058170
	speed: 0.0166s/iter; left time: 717.8128s
	iters: 1100, epoch: 1 | loss: 0.0027888
	speed: 0.0164s/iter; left time: 705.0668s
	iters: 1200, epoch: 1 | loss: 0.0045934
	speed: 0.0160s/iter; left time: 689.1111s
	iters: 1300, epoch: 1 | loss: 0.0037746
	speed: 0.0166s/iter; left time: 712.3884s
	iters: 1400, epoch: 1 | loss: 0.0047488
	speed: 0.0165s/iter; left time: 708.0648s
	iters: 1500, epoch: 1 | loss: 0.0043421
	speed: 0.0181s/iter; left time: 774.3355s
	iters: 1600, epoch: 1 | loss: 0.0028157
	speed: 0.0165s/iter; left time: 702.9424s
	iters: 1700, epoch: 1 | loss: 0.0049407
	speed: 0.0170s/iter; left time: 723.3505s
	iters: 1800, epoch: 1 | loss: 0.0064556
	speed: 0.0176s/iter; left time: 748.2390s
	iters: 1900, epoch: 1 | loss: 0.0031637
	speed: 0.0179s/iter; left time: 756.9170s
	iters: 2000, epoch: 1 | loss: 0.0034923
	speed: 0.0166s/iter; left time: 702.6689s
	iters: 2100, epoch: 1 | loss: 0.0039548
	speed: 0.0163s/iter; left time: 688.4040s
	iters: 2200, epoch: 1 | loss: 0.0026145
	speed: 0.0167s/iter; left time: 702.8834s
	iters: 2300, epoch: 1 | loss: 0.0058017
	speed: 0.0157s/iter; left time: 658.2323s
	iters: 2400, epoch: 1 | loss: 0.0035357
	speed: 0.0171s/iter; left time: 716.0688s
	iters: 2500, epoch: 1 | loss: 0.0050781
	speed: 0.0162s/iter; left time: 674.4516s
	iters: 2600, epoch: 1 | loss: 0.0036531
	speed: 0.0164s/iter; left time: 683.2444s
	iters: 2700, epoch: 1 | loss: 0.0022900
	speed: 0.0163s/iter; left time: 677.0720s
	iters: 2800, epoch: 1 | loss: 0.0027941
	speed: 0.0175s/iter; left time: 726.5780s
	iters: 2900, epoch: 1 | loss: 0.0026837
	speed: 0.0181s/iter; left time: 748.1722s
	iters: 3000, epoch: 1 | loss: 0.0032546
	speed: 0.0167s/iter; left time: 686.3490s
	iters: 3100, epoch: 1 | loss: 0.0026904
	speed: 0.0178s/iter; left time: 730.5100s
	iters: 3200, epoch: 1 | loss: 0.0038404
	speed: 0.0164s/iter; left time: 671.1473s
	iters: 3300, epoch: 1 | loss: 0.0042477
	speed: 0.0151s/iter; left time: 615.9226s
	iters: 3400, epoch: 1 | loss: 0.0047699
	speed: 0.0160s/iter; left time: 654.6600s
	iters: 3500, epoch: 1 | loss: 0.0056967
	speed: 0.0171s/iter; left time: 695.0692s
	iters: 3600, epoch: 1 | loss: 0.0025043
	speed: 0.0173s/iter; left time: 702.1628s
	iters: 3700, epoch: 1 | loss: 0.0038422
	speed: 0.0166s/iter; left time: 673.3881s
	iters: 3800, epoch: 1 | loss: 0.0046422
	speed: 0.0180s/iter; left time: 726.0506s
	iters: 3900, epoch: 1 | loss: 0.0032257
	speed: 0.0167s/iter; left time: 672.6328s
	iters: 4000, epoch: 1 | loss: 0.0053981
	speed: 0.0159s/iter; left time: 638.7975s
	iters: 4100, epoch: 1 | loss: 0.0022667
	speed: 0.0163s/iter; left time: 652.0839s
	iters: 4200, epoch: 1 | loss: 0.0033019
	speed: 0.0162s/iter; left time: 649.2863s
	iters: 4300, epoch: 1 | loss: 0.0031630
	speed: 0.0167s/iter; left time: 664.8753s
	iters: 4400, epoch: 1 | loss: 0.0021500
	speed: 0.0169s/iter; left time: 672.3847s
Epoch: 1 cost time: 75.97413802146912
Epoch: 1, Steps: 4421 | Train Loss: 0.0046999 Vali Loss: 0.0034214 Test Loss: 0.0058860
Validation loss decreased (inf --> 0.003421).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0035081
	speed: 1.8849s/iter; left time: 74811.2471s
	iters: 200, epoch: 2 | loss: 0.0031441
	speed: 0.0175s/iter; left time: 692.0908s
	iters: 300, epoch: 2 | loss: 0.0035369
	speed: 0.0167s/iter; left time: 660.9465s
	iters: 400, epoch: 2 | loss: 0.0029838
	speed: 0.0163s/iter; left time: 642.1382s
	iters: 500, epoch: 2 | loss: 0.0028576
	speed: 0.0160s/iter; left time: 629.9005s
	iters: 600, epoch: 2 | loss: 0.0047779
	speed: 0.0170s/iter; left time: 667.5550s
	iters: 700, epoch: 2 | loss: 0.0018618
	speed: 0.0163s/iter; left time: 636.8197s
	iters: 800, epoch: 2 | loss: 0.0029932
	speed: 0.0165s/iter; left time: 641.4765s
	iters: 900, epoch: 2 | loss: 0.0024519
	speed: 0.0164s/iter; left time: 636.5574s
	iters: 1000, epoch: 2 | loss: 0.0037832
	speed: 0.0169s/iter; left time: 656.2866s
	iters: 1100, epoch: 2 | loss: 0.0020264
	speed: 0.0166s/iter; left time: 642.9114s
	iters: 1200, epoch: 2 | loss: 0.0027039
	speed: 0.0167s/iter; left time: 646.3207s
	iters: 1300, epoch: 2 | loss: 0.0028621
	speed: 0.0182s/iter; left time: 698.6472s
	iters: 1400, epoch: 2 | loss: 0.0033845
	speed: 0.0167s/iter; left time: 641.8244s
	iters: 1500, epoch: 2 | loss: 0.0046393
	speed: 0.0169s/iter; left time: 647.0740s
	iters: 1600, epoch: 2 | loss: 0.0032033
	speed: 0.0179s/iter; left time: 681.9464s
	iters: 1700, epoch: 2 | loss: 0.0019476
	speed: 0.0178s/iter; left time: 677.4711s
	iters: 1800, epoch: 2 | loss: 0.0023060
	speed: 0.0167s/iter; left time: 635.2721s
	iters: 1900, epoch: 2 | loss: 0.0028609
	speed: 0.0175s/iter; left time: 663.0574s
	iters: 2000, epoch: 2 | loss: 0.0020126
	speed: 0.0162s/iter; left time: 613.1353s
	iters: 2100, epoch: 2 | loss: 0.0020325
	speed: 0.0155s/iter; left time: 582.8323s
	iters: 2200, epoch: 2 | loss: 0.0021474
	speed: 0.0160s/iter; left time: 601.1908s
	iters: 2300, epoch: 2 | loss: 0.0024147
	speed: 0.0158s/iter; left time: 593.3989s
	iters: 2400, epoch: 2 | loss: 0.0031548
	speed: 0.0170s/iter; left time: 636.7245s
	iters: 2500, epoch: 2 | loss: 0.0025811
	speed: 0.0168s/iter; left time: 626.3630s
	iters: 2600, epoch: 2 | loss: 0.0020539
	speed: 0.0167s/iter; left time: 619.4197s
	iters: 2700, epoch: 2 | loss: 0.0033979
	speed: 0.0174s/iter; left time: 646.9173s
	iters: 2800, epoch: 2 | loss: 0.0018582
	speed: 0.0177s/iter; left time: 653.1819s
	iters: 2900, epoch: 2 | loss: 0.0025274
	speed: 0.0177s/iter; left time: 651.5215s
	iters: 3000, epoch: 2 | loss: 0.0025306
	speed: 0.0164s/iter; left time: 601.9729s
	iters: 3100, epoch: 2 | loss: 0.0019749
	speed: 0.0162s/iter; left time: 592.5516s
	iters: 3200, epoch: 2 | loss: 0.0020438
	speed: 0.0167s/iter; left time: 609.8218s
	iters: 3300, epoch: 2 | loss: 0.0028033
	speed: 0.0175s/iter; left time: 639.3438s
	iters: 3400, epoch: 2 | loss: 0.0019694
	speed: 0.0173s/iter; left time: 630.9478s
	iters: 3500, epoch: 2 | loss: 0.0018805
	speed: 0.0173s/iter; left time: 627.7438s
	iters: 3600, epoch: 2 | loss: 0.0022424
	speed: 0.0172s/iter; left time: 622.2228s
	iters: 3700, epoch: 2 | loss: 0.0025663
	speed: 0.0168s/iter; left time: 607.6703s
	iters: 3800, epoch: 2 | loss: 0.0022037
	speed: 0.0168s/iter; left time: 605.4550s
	iters: 3900, epoch: 2 | loss: 0.0016110
	speed: 0.0185s/iter; left time: 663.3334s
	iters: 4000, epoch: 2 | loss: 0.0015885
	speed: 0.0166s/iter; left time: 593.5647s
	iters: 4100, epoch: 2 | loss: 0.0021712
	speed: 0.0181s/iter; left time: 646.9454s
	iters: 4200, epoch: 2 | loss: 0.0033430
	speed: 0.0168s/iter; left time: 599.2831s
	iters: 4300, epoch: 2 | loss: 0.0020069
	speed: 0.0164s/iter; left time: 581.5117s
	iters: 4400, epoch: 2 | loss: 0.0018596
	speed: 0.0164s/iter; left time: 579.4297s
Epoch: 2 cost time: 75.3772566318512
Epoch: 2, Steps: 4421 | Train Loss: 0.0027247 Vali Loss: 0.0028426 Test Loss: 0.0049546
Validation loss decreased (0.003421 --> 0.002843).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0026793
	speed: 1.8840s/iter; left time: 66445.6624s
	iters: 200, epoch: 3 | loss: 0.0019338
	speed: 0.0174s/iter; left time: 613.6590s
	iters: 300, epoch: 3 | loss: 0.0021026
	speed: 0.0179s/iter; left time: 629.3232s
	iters: 400, epoch: 3 | loss: 0.0014155
	speed: 0.0179s/iter; left time: 624.8127s
	iters: 500, epoch: 3 | loss: 0.0014721
	speed: 0.0165s/iter; left time: 575.4325s
	iters: 600, epoch: 3 | loss: 0.0017616
	speed: 0.0165s/iter; left time: 572.8128s
	iters: 700, epoch: 3 | loss: 0.0023318
	speed: 0.0167s/iter; left time: 577.8981s
	iters: 800, epoch: 3 | loss: 0.0012902
	speed: 0.0176s/iter; left time: 607.2279s
	iters: 900, epoch: 3 | loss: 0.0016585
	speed: 0.0163s/iter; left time: 563.2561s
	iters: 1000, epoch: 3 | loss: 0.0013871
	speed: 0.0183s/iter; left time: 628.2071s
	iters: 1100, epoch: 3 | loss: 0.0015260
	speed: 0.0178s/iter; left time: 609.3701s
	iters: 1200, epoch: 3 | loss: 0.0019467
	speed: 0.0165s/iter; left time: 563.5728s
	iters: 1300, epoch: 3 | loss: 0.0014246
	speed: 0.0153s/iter; left time: 521.0712s
	iters: 1400, epoch: 3 | loss: 0.0037825
	speed: 0.0172s/iter; left time: 584.4059s
	iters: 1500, epoch: 3 | loss: 0.0036653
	speed: 0.0163s/iter; left time: 551.9946s
	iters: 1600, epoch: 3 | loss: 0.0016533
	speed: 0.0157s/iter; left time: 529.4135s
	iters: 1700, epoch: 3 | loss: 0.0016533
	speed: 0.0171s/iter; left time: 577.3736s
	iters: 1800, epoch: 3 | loss: 0.0011183
	speed: 0.0163s/iter; left time: 548.6651s
	iters: 1900, epoch: 3 | loss: 0.0016950
	speed: 0.0165s/iter; left time: 550.9086s
	iters: 2000, epoch: 3 | loss: 0.0018336
	speed: 0.0164s/iter; left time: 548.5514s
	iters: 2100, epoch: 3 | loss: 0.0014533
	speed: 0.0168s/iter; left time: 557.2711s
	iters: 2200, epoch: 3 | loss: 0.0012310
	speed: 0.0156s/iter; left time: 517.4335s
	iters: 2300, epoch: 3 | loss: 0.0015418
	speed: 0.0157s/iter; left time: 520.6313s
	iters: 2400, epoch: 3 | loss: 0.0016083
	speed: 0.0172s/iter; left time: 566.6861s
	iters: 2500, epoch: 3 | loss: 0.0015082
	speed: 0.0171s/iter; left time: 563.7021s
	iters: 2600, epoch: 3 | loss: 0.0011833
	speed: 0.0172s/iter; left time: 563.9081s
	iters: 2700, epoch: 3 | loss: 0.0020839
	speed: 0.0168s/iter; left time: 548.7089s
	iters: 2800, epoch: 3 | loss: 0.0020137
	speed: 0.0167s/iter; left time: 545.5003s
	iters: 2900, epoch: 3 | loss: 0.0022609
	speed: 0.0179s/iter; left time: 580.2609s
	iters: 3000, epoch: 3 | loss: 0.0019044
	speed: 0.0166s/iter; left time: 536.0800s
	iters: 3100, epoch: 3 | loss: 0.0016827
	speed: 0.0185s/iter; left time: 595.9467s
	iters: 3200, epoch: 3 | loss: 0.0019837
	speed: 0.0160s/iter; left time: 516.0712s
	iters: 3300, epoch: 3 | loss: 0.0013890
	speed: 0.0164s/iter; left time: 526.9775s
	iters: 3400, epoch: 3 | loss: 0.0018538
	speed: 0.0163s/iter; left time: 520.7697s
	iters: 3500, epoch: 3 | loss: 0.0022931
	speed: 0.0159s/iter; left time: 505.1371s
	iters: 3600, epoch: 3 | loss: 0.0015692
	speed: 0.0164s/iter; left time: 519.9331s
	iters: 3700, epoch: 3 | loss: 0.0012245
	speed: 0.0176s/iter; left time: 557.4717s
	iters: 3800, epoch: 3 | loss: 0.0015983
	speed: 0.0168s/iter; left time: 529.1458s
	iters: 3900, epoch: 3 | loss: 0.0022907
	speed: 0.0176s/iter; left time: 555.3304s
	iters: 4000, epoch: 3 | loss: 0.0015518
	speed: 0.0169s/iter; left time: 530.2917s
	iters: 4100, epoch: 3 | loss: 0.0032402
	speed: 0.0166s/iter; left time: 518.9889s
	iters: 4200, epoch: 3 | loss: 0.0011665
	speed: 0.0166s/iter; left time: 517.9932s
	iters: 4300, epoch: 3 | loss: 0.0022121
	speed: 0.0173s/iter; left time: 537.5838s
	iters: 4400, epoch: 3 | loss: 0.0018389
	speed: 0.0168s/iter; left time: 520.1203s
Epoch: 3 cost time: 75.14703512191772
Epoch: 3, Steps: 4421 | Train Loss: 0.0017849 Vali Loss: 0.0026091 Test Loss: 0.0047717
Validation loss decreased (0.002843 --> 0.002609).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0027891
	speed: 1.8968s/iter; left time: 58512.1365s
	iters: 200, epoch: 4 | loss: 0.0019657
	speed: 0.0168s/iter; left time: 516.0190s
	iters: 300, epoch: 4 | loss: 0.0015550
	speed: 0.0168s/iter; left time: 513.4308s
	iters: 400, epoch: 4 | loss: 0.0022385
	speed: 0.0160s/iter; left time: 489.8799s
	iters: 500, epoch: 4 | loss: 0.0015641
	speed: 0.0154s/iter; left time: 468.2702s
	iters: 600, epoch: 4 | loss: 0.0018219
	speed: 0.0169s/iter; left time: 513.0954s
	iters: 700, epoch: 4 | loss: 0.0014519
	speed: 0.0184s/iter; left time: 555.0861s
	iters: 800, epoch: 4 | loss: 0.0014772
	speed: 0.0192s/iter; left time: 578.7657s
	iters: 900, epoch: 4 | loss: 0.0021012
	speed: 0.0187s/iter; left time: 560.8977s
	iters: 1000, epoch: 4 | loss: 0.0015704
	speed: 0.0175s/iter; left time: 523.9966s
	iters: 1100, epoch: 4 | loss: 0.0011781
	speed: 0.0158s/iter; left time: 472.5335s
	iters: 1200, epoch: 4 | loss: 0.0012243
	speed: 0.0165s/iter; left time: 489.9609s
	iters: 1300, epoch: 4 | loss: 0.0013398
	speed: 0.0160s/iter; left time: 475.7202s
	iters: 1400, epoch: 4 | loss: 0.0014719
	speed: 0.0167s/iter; left time: 492.1661s
	iters: 1500, epoch: 4 | loss: 0.0010392
	speed: 0.0159s/iter; left time: 467.0325s
	iters: 1600, epoch: 4 | loss: 0.0016638
	speed: 0.0162s/iter; left time: 474.5139s
	iters: 1700, epoch: 4 | loss: 0.0017768
	speed: 0.0164s/iter; left time: 480.8362s
	iters: 1800, epoch: 4 | loss: 0.0009260
	speed: 0.0164s/iter; left time: 478.6631s
	iters: 1900, epoch: 4 | loss: 0.0016612
	speed: 0.0167s/iter; left time: 485.5154s
	iters: 2000, epoch: 4 | loss: 0.0016529
	speed: 0.0154s/iter; left time: 446.8037s
	iters: 2100, epoch: 4 | loss: 0.0018342
	speed: 0.0164s/iter; left time: 472.0236s
	iters: 2200, epoch: 4 | loss: 0.0010957
	speed: 0.0171s/iter; left time: 491.8059s
	iters: 2300, epoch: 4 | loss: 0.0016495
	speed: 0.0173s/iter; left time: 494.3752s
	iters: 2400, epoch: 4 | loss: 0.0012321
	speed: 0.0184s/iter; left time: 524.1863s
	iters: 2500, epoch: 4 | loss: 0.0013012
	speed: 0.0166s/iter; left time: 471.9089s
	iters: 2600, epoch: 4 | loss: 0.0017752
	speed: 0.0172s/iter; left time: 487.6622s
	iters: 2700, epoch: 4 | loss: 0.0011260
	speed: 0.0159s/iter; left time: 448.7954s
	iters: 2800, epoch: 4 | loss: 0.0018807
	speed: 0.0162s/iter; left time: 455.8429s
	iters: 2900, epoch: 4 | loss: 0.0011143
	speed: 0.0164s/iter; left time: 459.2234s
	iters: 3000, epoch: 4 | loss: 0.0010398
	speed: 0.0174s/iter; left time: 485.7511s
	iters: 3100, epoch: 4 | loss: 0.0010731
	speed: 0.0168s/iter; left time: 467.1472s
	iters: 3200, epoch: 4 | loss: 0.0018540
	speed: 0.0181s/iter; left time: 503.3434s
	iters: 3300, epoch: 4 | loss: 0.0013347
	speed: 0.0166s/iter; left time: 458.4359s
	iters: 3400, epoch: 4 | loss: 0.0015301
	speed: 0.0179s/iter; left time: 492.9237s
	iters: 3500, epoch: 4 | loss: 0.0011501
	speed: 0.0175s/iter; left time: 481.5282s
	iters: 3600, epoch: 4 | loss: 0.0019901
	speed: 0.0168s/iter; left time: 459.6347s
	iters: 3700, epoch: 4 | loss: 0.0021092
	speed: 0.0170s/iter; left time: 462.3357s
	iters: 3800, epoch: 4 | loss: 0.0011106
	speed: 0.0173s/iter; left time: 470.3980s
	iters: 3900, epoch: 4 | loss: 0.0007957
	speed: 0.0163s/iter; left time: 439.9465s
	iters: 4000, epoch: 4 | loss: 0.0014508
	speed: 0.0167s/iter; left time: 450.0837s
	iters: 4100, epoch: 4 | loss: 0.0012194
	speed: 0.0167s/iter; left time: 449.4997s
	iters: 4200, epoch: 4 | loss: 0.0014879
	speed: 0.0163s/iter; left time: 434.9284s
	iters: 4300, epoch: 4 | loss: 0.0018460
	speed: 0.0171s/iter; left time: 456.2243s
	iters: 4400, epoch: 4 | loss: 0.0014953
	speed: 0.0173s/iter; left time: 459.4002s
Epoch: 4 cost time: 75.19424390792847
Epoch: 4, Steps: 4421 | Train Loss: 0.0014153 Vali Loss: 0.0025545 Test Loss: 0.0046122
Validation loss decreased (0.002609 --> 0.002555).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0014914
	speed: 1.8762s/iter; left time: 49581.5461s
	iters: 200, epoch: 5 | loss: 0.0009250
	speed: 0.0162s/iter; left time: 427.3933s
	iters: 300, epoch: 5 | loss: 0.0011802
	speed: 0.0175s/iter; left time: 459.9034s
	iters: 400, epoch: 5 | loss: 0.0009522
	speed: 0.0173s/iter; left time: 452.0058s
	iters: 500, epoch: 5 | loss: 0.0013907
	speed: 0.0183s/iter; left time: 476.0994s
	iters: 600, epoch: 5 | loss: 0.0009243
	speed: 0.0167s/iter; left time: 433.7299s
	iters: 700, epoch: 5 | loss: 0.0013785
	speed: 0.0167s/iter; left time: 431.1572s
	iters: 800, epoch: 5 | loss: 0.0013140
	speed: 0.0179s/iter; left time: 459.2369s
	iters: 900, epoch: 5 | loss: 0.0012961
	speed: 0.0182s/iter; left time: 466.0635s
	iters: 1000, epoch: 5 | loss: 0.0013944
	speed: 0.0171s/iter; left time: 436.3796s
	iters: 1100, epoch: 5 | loss: 0.0013308
	speed: 0.0168s/iter; left time: 428.1111s
	iters: 1200, epoch: 5 | loss: 0.0010036
	speed: 0.0163s/iter; left time: 412.4654s
	iters: 1300, epoch: 5 | loss: 0.0014328
	speed: 0.0172s/iter; left time: 434.9869s
	iters: 1400, epoch: 5 | loss: 0.0012204
	speed: 0.0177s/iter; left time: 445.1831s
	iters: 1500, epoch: 5 | loss: 0.0008283
	speed: 0.0162s/iter; left time: 405.7751s
	iters: 1600, epoch: 5 | loss: 0.0012032
	speed: 0.0154s/iter; left time: 383.2866s
	iters: 1700, epoch: 5 | loss: 0.0010472
	speed: 0.0160s/iter; left time: 396.3388s
	iters: 1800, epoch: 5 | loss: 0.0011197
	speed: 0.0170s/iter; left time: 419.4895s
	iters: 1900, epoch: 5 | loss: 0.0008881
	speed: 0.0172s/iter; left time: 424.6091s
	iters: 2000, epoch: 5 | loss: 0.0011319
	speed: 0.0159s/iter; left time: 388.8435s
	iters: 2100, epoch: 5 | loss: 0.0014997
	speed: 0.0169s/iter; left time: 411.8795s
	iters: 2200, epoch: 5 | loss: 0.0028046
	speed: 0.0171s/iter; left time: 416.2786s
	iters: 2300, epoch: 5 | loss: 0.0010105
	speed: 0.0182s/iter; left time: 440.3285s
	iters: 2400, epoch: 5 | loss: 0.0010300
	speed: 0.0173s/iter; left time: 418.2631s
	iters: 2500, epoch: 5 | loss: 0.0014081
	speed: 0.0167s/iter; left time: 401.3174s
	iters: 2600, epoch: 5 | loss: 0.0013356
	speed: 0.0162s/iter; left time: 388.4981s
	iters: 2700, epoch: 5 | loss: 0.0011641
	speed: 0.0169s/iter; left time: 401.9124s
	iters: 2800, epoch: 5 | loss: 0.0031161
	speed: 0.0165s/iter; left time: 390.3313s
	iters: 2900, epoch: 5 | loss: 0.0011144
	speed: 0.0163s/iter; left time: 385.7276s
	iters: 3000, epoch: 5 | loss: 0.0011278
	speed: 0.0168s/iter; left time: 396.2858s
	iters: 3100, epoch: 5 | loss: 0.0015021
	speed: 0.0172s/iter; left time: 402.0187s
	iters: 3200, epoch: 5 | loss: 0.0009674
	speed: 0.0166s/iter; left time: 386.1531s
	iters: 3300, epoch: 5 | loss: 0.0010253
	speed: 0.0169s/iter; left time: 392.3752s
	iters: 3400, epoch: 5 | loss: 0.0010923
	speed: 0.0168s/iter; left time: 389.5516s
	iters: 3500, epoch: 5 | loss: 0.0010466
	speed: 0.0158s/iter; left time: 363.7406s
	iters: 3600, epoch: 5 | loss: 0.0012793
	speed: 0.0160s/iter; left time: 367.3296s
	iters: 3700, epoch: 5 | loss: 0.0009579
	speed: 0.0173s/iter; left time: 394.5357s
	iters: 3800, epoch: 5 | loss: 0.0017704
	speed: 0.0163s/iter; left time: 370.5913s
	iters: 3900, epoch: 5 | loss: 0.0009482
	speed: 0.0162s/iter; left time: 365.6484s
	iters: 4000, epoch: 5 | loss: 0.0011032
	speed: 0.0172s/iter; left time: 387.0247s
	iters: 4100, epoch: 5 | loss: 0.0013559
	speed: 0.0179s/iter; left time: 401.7094s
	iters: 4200, epoch: 5 | loss: 0.0015984
	speed: 0.0178s/iter; left time: 396.8414s
	iters: 4300, epoch: 5 | loss: 0.0012812
	speed: 0.0179s/iter; left time: 398.1604s
	iters: 4400, epoch: 5 | loss: 0.0016133
	speed: 0.0169s/iter; left time: 374.7028s
Epoch: 5 cost time: 75.29348850250244
Epoch: 5, Steps: 4421 | Train Loss: 0.0012473 Vali Loss: 0.0025119 Test Loss: 0.0044455
Validation loss decreased (0.002555 --> 0.002512).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0012544
	speed: 1.8896s/iter; left time: 41581.9752s
	iters: 200, epoch: 6 | loss: 0.0013022
	speed: 0.0175s/iter; left time: 383.6308s
	iters: 300, epoch: 6 | loss: 0.0012830
	speed: 0.0168s/iter; left time: 366.5375s
	iters: 400, epoch: 6 | loss: 0.0012391
	speed: 0.0171s/iter; left time: 371.8477s
	iters: 500, epoch: 6 | loss: 0.0011837
	speed: 0.0166s/iter; left time: 359.1879s
	iters: 600, epoch: 6 | loss: 0.0007572
	speed: 0.0163s/iter; left time: 350.3090s
	iters: 700, epoch: 6 | loss: 0.0012559
	speed: 0.0171s/iter; left time: 365.4812s
	iters: 800, epoch: 6 | loss: 0.0013032
	speed: 0.0168s/iter; left time: 357.5012s
	iters: 900, epoch: 6 | loss: 0.0013786
	speed: 0.0160s/iter; left time: 339.7655s
	iters: 1000, epoch: 6 | loss: 0.0023587
	speed: 0.0175s/iter; left time: 370.0346s
	iters: 1100, epoch: 6 | loss: 0.0020093
	speed: 0.0167s/iter; left time: 350.2546s
	iters: 1200, epoch: 6 | loss: 0.0008052
	speed: 0.0159s/iter; left time: 332.8305s
	iters: 1300, epoch: 6 | loss: 0.0017051
	speed: 0.0176s/iter; left time: 366.1466s
	iters: 1400, epoch: 6 | loss: 0.0011688
	speed: 0.0186s/iter; left time: 385.8687s
	iters: 1500, epoch: 6 | loss: 0.0010316
	speed: 0.0178s/iter; left time: 367.0625s
	iters: 1600, epoch: 6 | loss: 0.0007772
	speed: 0.0174s/iter; left time: 356.6094s
	iters: 1700, epoch: 6 | loss: 0.0008745
	speed: 0.0172s/iter; left time: 351.1969s
	iters: 1800, epoch: 6 | loss: 0.0012519
	speed: 0.0165s/iter; left time: 335.5986s
	iters: 1900, epoch: 6 | loss: 0.0007053
	speed: 0.0165s/iter; left time: 334.2543s
	iters: 2000, epoch: 6 | loss: 0.0009970
	speed: 0.0164s/iter; left time: 329.4655s
	iters: 2100, epoch: 6 | loss: 0.0010423
	speed: 0.0169s/iter; left time: 337.6058s
	iters: 2200, epoch: 6 | loss: 0.0019333
	speed: 0.0180s/iter; left time: 358.9396s
	iters: 2300, epoch: 6 | loss: 0.0009383
	speed: 0.0177s/iter; left time: 350.7350s
	iters: 2400, epoch: 6 | loss: 0.0011762
	speed: 0.0183s/iter; left time: 359.7642s
	iters: 2500, epoch: 6 | loss: 0.0012281
	speed: 0.0168s/iter; left time: 328.6417s
	iters: 2600, epoch: 6 | loss: 0.0009010
	speed: 0.0170s/iter; left time: 330.9526s
	iters: 2700, epoch: 6 | loss: 0.0008245
	speed: 0.0169s/iter; left time: 327.9829s
	iters: 2800, epoch: 6 | loss: 0.0008056
	speed: 0.0166s/iter; left time: 320.1888s
	iters: 2900, epoch: 6 | loss: 0.0007768
	speed: 0.0171s/iter; left time: 328.1068s
	iters: 3000, epoch: 6 | loss: 0.0009767
	speed: 0.0172s/iter; left time: 327.8630s
	iters: 3100, epoch: 6 | loss: 0.0007775
	speed: 0.0183s/iter; left time: 348.0008s
	iters: 3200, epoch: 6 | loss: 0.0011023
	speed: 0.0182s/iter; left time: 343.3072s
	iters: 3300, epoch: 6 | loss: 0.0009154
	speed: 0.0181s/iter; left time: 340.6282s
	iters: 3400, epoch: 6 | loss: 0.0010230
	speed: 0.0188s/iter; left time: 351.3645s
	iters: 3500, epoch: 6 | loss: 0.0028779
	speed: 0.0190s/iter; left time: 352.7384s
	iters: 3600, epoch: 6 | loss: 0.0011493
	speed: 0.0191s/iter; left time: 352.8462s
	iters: 3700, epoch: 6 | loss: 0.0012436
	speed: 0.0194s/iter; left time: 357.0030s
	iters: 3800, epoch: 6 | loss: 0.0011402
	speed: 0.0184s/iter; left time: 336.5702s
	iters: 3900, epoch: 6 | loss: 0.0009906
	speed: 0.0185s/iter; left time: 336.0608s
	iters: 4000, epoch: 6 | loss: 0.0009415
	speed: 0.0161s/iter; left time: 290.6509s
	iters: 4100, epoch: 6 | loss: 0.0012452
	speed: 0.0166s/iter; left time: 299.6658s
	iters: 4200, epoch: 6 | loss: 0.0010745
	speed: 0.0164s/iter; left time: 292.9425s
	iters: 4300, epoch: 6 | loss: 0.0009872
	speed: 0.0171s/iter; left time: 305.0054s
	iters: 4400, epoch: 6 | loss: 0.0015351
	speed: 0.0187s/iter; left time: 330.6648s
Epoch: 6 cost time: 77.47219204902649
Epoch: 6, Steps: 4421 | Train Loss: 0.0011731 Vali Loss: 0.0025739 Test Loss: 0.0045963
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0011523
	speed: 1.8995s/iter; left time: 33402.1581s
	iters: 200, epoch: 7 | loss: 0.0015725
	speed: 0.0171s/iter; left time: 298.6222s
	iters: 300, epoch: 7 | loss: 0.0011827
	speed: 0.0177s/iter; left time: 308.2999s
	iters: 400, epoch: 7 | loss: 0.0015696
	speed: 0.0183s/iter; left time: 315.5418s
	iters: 500, epoch: 7 | loss: 0.0010437
	speed: 0.0165s/iter; left time: 282.8340s
	iters: 600, epoch: 7 | loss: 0.0009275
	speed: 0.0172s/iter; left time: 294.3806s
	iters: 700, epoch: 7 | loss: 0.0009030
	speed: 0.0180s/iter; left time: 305.4502s
	iters: 800, epoch: 7 | loss: 0.0010858
	speed: 0.0182s/iter; left time: 307.8842s
	iters: 900, epoch: 7 | loss: 0.0011016
	speed: 0.0177s/iter; left time: 296.8119s
	iters: 1000, epoch: 7 | loss: 0.0010527
	speed: 0.0167s/iter; left time: 278.0746s
	iters: 1100, epoch: 7 | loss: 0.0013739
	speed: 0.0167s/iter; left time: 276.2756s
	iters: 1200, epoch: 7 | loss: 0.0008126
	speed: 0.0165s/iter; left time: 271.8600s
	iters: 1300, epoch: 7 | loss: 0.0013460
	speed: 0.0171s/iter; left time: 279.8550s
	iters: 1400, epoch: 7 | loss: 0.0008422
	speed: 0.0175s/iter; left time: 285.4903s
	iters: 1500, epoch: 7 | loss: 0.0010481
	speed: 0.0172s/iter; left time: 279.0042s
	iters: 1600, epoch: 7 | loss: 0.0011987
	speed: 0.0163s/iter; left time: 262.7141s
	iters: 1700, epoch: 7 | loss: 0.0008691
	speed: 0.0170s/iter; left time: 271.4549s
	iters: 1800, epoch: 7 | loss: 0.0011084
	speed: 0.0163s/iter; left time: 259.6420s
	iters: 1900, epoch: 7 | loss: 0.0010444
	speed: 0.0179s/iter; left time: 283.0897s
	iters: 2000, epoch: 7 | loss: 0.0012401
	speed: 0.0172s/iter; left time: 269.7893s
	iters: 2100, epoch: 7 | loss: 0.0013621
	speed: 0.0159s/iter; left time: 248.2303s
	iters: 2200, epoch: 7 | loss: 0.0008774
	speed: 0.0166s/iter; left time: 257.5392s
	iters: 2300, epoch: 7 | loss: 0.0010365
	speed: 0.0164s/iter; left time: 252.4935s
	iters: 2400, epoch: 7 | loss: 0.0009775
	speed: 0.0171s/iter; left time: 261.3645s
	iters: 2500, epoch: 7 | loss: 0.0008964
	speed: 0.0166s/iter; left time: 251.9662s
	iters: 2600, epoch: 7 | loss: 0.0018336
	speed: 0.0170s/iter; left time: 256.6915s
	iters: 2700, epoch: 7 | loss: 0.0011657
	speed: 0.0174s/iter; left time: 261.3216s
	iters: 2800, epoch: 7 | loss: 0.0013025
	speed: 0.0161s/iter; left time: 239.3619s
	iters: 2900, epoch: 7 | loss: 0.0011165
	speed: 0.0162s/iter; left time: 239.0707s
	iters: 3000, epoch: 7 | loss: 0.0008917
	speed: 0.0149s/iter; left time: 219.2959s
	iters: 3100, epoch: 7 | loss: 0.0014860
	speed: 0.0161s/iter; left time: 234.4373s
	iters: 3200, epoch: 7 | loss: 0.0009946
	speed: 0.0170s/iter; left time: 246.2602s
	iters: 3300, epoch: 7 | loss: 0.0024963
	speed: 0.0158s/iter; left time: 227.9175s
	iters: 3400, epoch: 7 | loss: 0.0008903
	speed: 0.0177s/iter; left time: 253.4455s
	iters: 3500, epoch: 7 | loss: 0.0009596
	speed: 0.0174s/iter; left time: 246.8297s
	iters: 3600, epoch: 7 | loss: 0.0012856
	speed: 0.0175s/iter; left time: 246.4218s
	iters: 3700, epoch: 7 | loss: 0.0011664
	speed: 0.0170s/iter; left time: 237.0987s
	iters: 3800, epoch: 7 | loss: 0.0007037
	speed: 0.0173s/iter; left time: 240.6082s
	iters: 3900, epoch: 7 | loss: 0.0010293
	speed: 0.0165s/iter; left time: 227.9164s
	iters: 4000, epoch: 7 | loss: 0.0014796
	speed: 0.0168s/iter; left time: 229.4773s
	iters: 4100, epoch: 7 | loss: 0.0013179
	speed: 0.0167s/iter; left time: 227.1778s
	iters: 4200, epoch: 7 | loss: 0.0008837
	speed: 0.0167s/iter; left time: 225.2470s
	iters: 4300, epoch: 7 | loss: 0.0007389
	speed: 0.0164s/iter; left time: 218.9878s
	iters: 4400, epoch: 7 | loss: 0.0009678
	speed: 0.0163s/iter; left time: 217.0132s
Epoch: 7 cost time: 75.29742980003357
Epoch: 7, Steps: 4421 | Train Loss: 0.0011339 Vali Loss: 0.0025418 Test Loss: 0.0045608
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0009370
	speed: 1.9190s/iter; left time: 25261.2945s
	iters: 200, epoch: 8 | loss: 0.0008859
	speed: 0.0168s/iter; left time: 220.0943s
	iters: 300, epoch: 8 | loss: 0.0009374
	speed: 0.0158s/iter; left time: 204.9947s
	iters: 400, epoch: 8 | loss: 0.0005716
	speed: 0.0176s/iter; left time: 226.9751s
	iters: 500, epoch: 8 | loss: 0.0008012
	speed: 0.0166s/iter; left time: 211.7239s
	iters: 600, epoch: 8 | loss: 0.0008619
	speed: 0.0171s/iter; left time: 216.4247s
	iters: 700, epoch: 8 | loss: 0.0011786
	speed: 0.0186s/iter; left time: 233.4423s
	iters: 800, epoch: 8 | loss: 0.0009014
	speed: 0.0177s/iter; left time: 220.9258s
	iters: 900, epoch: 8 | loss: 0.0008541
	speed: 0.0182s/iter; left time: 224.8506s
	iters: 1000, epoch: 8 | loss: 0.0011619
	speed: 0.0158s/iter; left time: 193.9486s
	iters: 1100, epoch: 8 | loss: 0.0010931
	speed: 0.0163s/iter; left time: 197.9008s
	iters: 1200, epoch: 8 | loss: 0.0008109
	speed: 0.0184s/iter; left time: 222.2438s
	iters: 1300, epoch: 8 | loss: 0.0010528
	speed: 0.0167s/iter; left time: 199.2545s
	iters: 1400, epoch: 8 | loss: 0.0011408
	speed: 0.0170s/iter; left time: 201.5495s
	iters: 1500, epoch: 8 | loss: 0.0010335
	speed: 0.0161s/iter; left time: 189.3106s
	iters: 1600, epoch: 8 | loss: 0.0011555
	speed: 0.0171s/iter; left time: 199.4851s
	iters: 1700, epoch: 8 | loss: 0.0011618
	speed: 0.0166s/iter; left time: 191.9680s
	iters: 1800, epoch: 8 | loss: 0.0009975
	speed: 0.0159s/iter; left time: 182.5533s
	iters: 1900, epoch: 8 | loss: 0.0007598
	speed: 0.0154s/iter; left time: 175.1405s
	iters: 2000, epoch: 8 | loss: 0.0008186
	speed: 0.0156s/iter; left time: 176.2023s
	iters: 2100, epoch: 8 | loss: 0.0009956
	speed: 0.0171s/iter; left time: 191.2593s
	iters: 2200, epoch: 8 | loss: 0.0009147
	speed: 0.0165s/iter; left time: 182.0972s
	iters: 2300, epoch: 8 | loss: 0.0014456
	speed: 0.0172s/iter; left time: 188.1989s
	iters: 2400, epoch: 8 | loss: 0.0008070
	speed: 0.0176s/iter; left time: 191.2184s
	iters: 2500, epoch: 8 | loss: 0.0011636
	speed: 0.0171s/iter; left time: 184.0904s
	iters: 2600, epoch: 8 | loss: 0.0012524
	speed: 0.0171s/iter; left time: 181.8507s
	iters: 2700, epoch: 8 | loss: 0.0012793
	speed: 0.0183s/iter; left time: 193.0150s
	iters: 2800, epoch: 8 | loss: 0.0009950
	speed: 0.0176s/iter; left time: 183.7396s
	iters: 2900, epoch: 8 | loss: 0.0007664
	speed: 0.0167s/iter; left time: 172.8425s
	iters: 3000, epoch: 8 | loss: 0.0008513
	speed: 0.0166s/iter; left time: 170.1144s
	iters: 3100, epoch: 8 | loss: 0.0009992
	speed: 0.0173s/iter; left time: 175.7737s
	iters: 3200, epoch: 8 | loss: 0.0008847
	speed: 0.0175s/iter; left time: 176.2553s
	iters: 3300, epoch: 8 | loss: 0.0008863
	speed: 0.0176s/iter; left time: 175.6558s
	iters: 3400, epoch: 8 | loss: 0.0009324
	speed: 0.0188s/iter; left time: 185.3762s
	iters: 3500, epoch: 8 | loss: 0.0009460
	speed: 0.0183s/iter; left time: 178.7530s
	iters: 3600, epoch: 8 | loss: 0.0010058
	speed: 0.0185s/iter; left time: 178.4706s
	iters: 3700, epoch: 8 | loss: 0.0008924
	speed: 0.0169s/iter; left time: 161.2845s
	iters: 3800, epoch: 8 | loss: 0.0006987
	speed: 0.0173s/iter; left time: 164.1842s
	iters: 3900, epoch: 8 | loss: 0.0010150
	speed: 0.0166s/iter; left time: 154.9858s
	iters: 4000, epoch: 8 | loss: 0.0009854
	speed: 0.0182s/iter; left time: 168.8850s
	iters: 4100, epoch: 8 | loss: 0.0008190
	speed: 0.0180s/iter; left time: 164.5031s
	iters: 4200, epoch: 8 | loss: 0.0010039
	speed: 0.0178s/iter; left time: 160.9058s
	iters: 4300, epoch: 8 | loss: 0.0008726
	speed: 0.0181s/iter; left time: 161.9401s
	iters: 4400, epoch: 8 | loss: 0.0010089
	speed: 0.0169s/iter; left time: 149.7517s
Epoch: 8 cost time: 76.6382999420166
Epoch: 8, Steps: 4421 | Train Loss: 0.0011137 Vali Loss: 0.0025593 Test Loss: 0.0045872
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : test_iTransformer_custom_MS_ft731_sl731_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40617
Traceback (most recent call last):
  File "/root/iTransformer/run.py", line 135, in <module>
    exp.test(setting)
  File "/root/iTransformer/experiments/exp_long_term_forecasting.py", line 237, in test
    outputs = test_data.inverse_transform(outputs.squeeze(0)).reshape(shape)
  File "/root/iTransformer/data_provider/data_loader.py", line 298, in inverse_transform
    x, y, z = data.shape
ValueError: not enough values to unpack (expected 3, got 2)
