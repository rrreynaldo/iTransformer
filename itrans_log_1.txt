Args in experiment:
Namespace(is_training=1, model_id='test', model='iTransformer', data='custom', root_path='./target_data', data_path='data_test_4.csv', features='MS', target='WaterTemperature', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=24, enc_in=7, dec_in=7, c_out=21, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=5, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
>>>>>>>start training : test_iTransformer_custom_MS_ft96_sl48_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 142121
val 20298
test 40617
	iters: 100, epoch: 1 | loss: 0.0035612
	speed: 0.0655s/iter; left time: 1447.1643s
	iters: 200, epoch: 1 | loss: 0.0029896
	speed: 0.0168s/iter; left time: 369.8046s
	iters: 300, epoch: 1 | loss: 0.0041645
	speed: 0.0171s/iter; left time: 373.5522s
	iters: 400, epoch: 1 | loss: 0.0044803
	speed: 0.0172s/iter; left time: 374.3304s
	iters: 500, epoch: 1 | loss: 0.0034223
	speed: 0.0168s/iter; left time: 364.3638s
	iters: 600, epoch: 1 | loss: 0.0105709
	speed: 0.0170s/iter; left time: 366.3672s
	iters: 700, epoch: 1 | loss: 0.0086824
	speed: 0.0165s/iter; left time: 354.3767s
	iters: 800, epoch: 1 | loss: 0.0034840
	speed: 0.0165s/iter; left time: 353.3973s
	iters: 900, epoch: 1 | loss: 0.0031267
	speed: 0.0169s/iter; left time: 359.2972s
	iters: 1000, epoch: 1 | loss: 0.0039208
	speed: 0.0168s/iter; left time: 357.1178s
	iters: 1100, epoch: 1 | loss: 0.0044537
	speed: 0.0170s/iter; left time: 358.7652s
	iters: 1200, epoch: 1 | loss: 0.0042644
	speed: 0.0169s/iter; left time: 355.2549s
	iters: 1300, epoch: 1 | loss: 0.0030696
	speed: 0.0172s/iter; left time: 358.9913s
	iters: 1400, epoch: 1 | loss: 0.0035726
	speed: 0.0319s/iter; left time: 662.7578s
	iters: 1500, epoch: 1 | loss: 0.0026015
	speed: 0.0174s/iter; left time: 359.5564s
	iters: 1600, epoch: 1 | loss: 0.0022144
	speed: 0.0171s/iter; left time: 353.3270s
	iters: 1700, epoch: 1 | loss: 0.0051004
	speed: 0.0171s/iter; left time: 349.7483s
	iters: 1800, epoch: 1 | loss: 0.0033665
	speed: 0.0169s/iter; left time: 345.1296s
	iters: 1900, epoch: 1 | loss: 0.0031578
	speed: 0.0170s/iter; left time: 346.1308s
	iters: 2000, epoch: 1 | loss: 0.0059973
	speed: 0.0168s/iter; left time: 339.9865s
	iters: 2100, epoch: 1 | loss: 0.0027916
	speed: 0.0166s/iter; left time: 333.9792s
	iters: 2200, epoch: 1 | loss: 0.0049819
	speed: 0.0167s/iter; left time: 334.7925s
	iters: 2300, epoch: 1 | loss: 0.0042504
	speed: 0.0165s/iter; left time: 329.0737s
	iters: 2400, epoch: 1 | loss: 0.0022090
	speed: 0.0166s/iter; left time: 329.2325s
	iters: 2500, epoch: 1 | loss: 0.0035912
	speed: 0.0170s/iter; left time: 334.2689s
	iters: 2600, epoch: 1 | loss: 0.0046869
	speed: 0.0168s/iter; left time: 329.7526s
	iters: 2700, epoch: 1 | loss: 0.0027360
	speed: 0.0167s/iter; left time: 325.5138s
	iters: 2800, epoch: 1 | loss: 0.0021338
	speed: 0.0168s/iter; left time: 325.1513s
	iters: 2900, epoch: 1 | loss: 0.0041448
	speed: 0.0174s/iter; left time: 335.3703s
	iters: 3000, epoch: 1 | loss: 0.0045434
	speed: 0.0169s/iter; left time: 324.5049s
	iters: 3100, epoch: 1 | loss: 0.0037170
	speed: 0.0176s/iter; left time: 336.5107s
	iters: 3200, epoch: 1 | loss: 0.0032803
	speed: 0.0168s/iter; left time: 319.2092s
	iters: 3300, epoch: 1 | loss: 0.0022498
	speed: 0.0169s/iter; left time: 319.9764s
	iters: 3400, epoch: 1 | loss: 0.0041744
	speed: 0.0163s/iter; left time: 307.3439s
	iters: 3500, epoch: 1 | loss: 0.0037100
	speed: 0.0167s/iter; left time: 312.1582s
	iters: 3600, epoch: 1 | loss: 0.0045709
	speed: 0.0164s/iter; left time: 305.2275s
	iters: 3700, epoch: 1 | loss: 0.0025590
	speed: 0.0164s/iter; left time: 303.2590s
	iters: 3800, epoch: 1 | loss: 0.0024864
	speed: 0.0169s/iter; left time: 310.1494s
	iters: 3900, epoch: 1 | loss: 0.0028831
	speed: 0.0168s/iter; left time: 307.2776s
	iters: 4000, epoch: 1 | loss: 0.0021433
	speed: 0.0165s/iter; left time: 300.1475s
	iters: 4100, epoch: 1 | loss: 0.0019237
	speed: 0.0171s/iter; left time: 310.2302s
	iters: 4200, epoch: 1 | loss: 0.0040992
	speed: 0.0164s/iter; left time: 295.5290s
	iters: 4300, epoch: 1 | loss: 0.0041462
	speed: 0.0162s/iter; left time: 289.3218s
	iters: 4400, epoch: 1 | loss: 0.0013741
	speed: 0.0170s/iter; left time: 303.5566s
Epoch: 1 cost time: 81.12816524505615
Epoch: 1, Steps: 4441 | Train Loss: 0.0038142 Vali Loss: 0.0016048 Test Loss: 0.0026748
Validation loss decreased (inf --> 0.001605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0058316
	speed: 2.8266s/iter; left time: 49931.3426s
	iters: 200, epoch: 2 | loss: 0.0026335
	speed: 0.0170s/iter; left time: 298.9843s
	iters: 300, epoch: 2 | loss: 0.0017413
	speed: 0.0167s/iter; left time: 291.7145s
	iters: 400, epoch: 2 | loss: 0.0034550
	speed: 0.0165s/iter; left time: 285.7378s
	iters: 500, epoch: 2 | loss: 0.0055484
	speed: 0.0167s/iter; left time: 288.9102s
	iters: 600, epoch: 2 | loss: 0.0031609
	speed: 0.0164s/iter; left time: 281.6265s
	iters: 700, epoch: 2 | loss: 0.0018630
	speed: 0.0167s/iter; left time: 284.4921s
	iters: 800, epoch: 2 | loss: 0.0020374
	speed: 0.0167s/iter; left time: 282.4889s
	iters: 900, epoch: 2 | loss: 0.0022585
	speed: 0.0167s/iter; left time: 282.3659s
	iters: 1000, epoch: 2 | loss: 0.0055910
	speed: 0.0163s/iter; left time: 273.5357s
	iters: 1100, epoch: 2 | loss: 0.0024743
	speed: 0.0162s/iter; left time: 270.4720s
	iters: 1200, epoch: 2 | loss: 0.0048138
	speed: 0.0163s/iter; left time: 270.8032s
	iters: 1300, epoch: 2 | loss: 0.0021950
	speed: 0.0170s/iter; left time: 279.6021s
	iters: 1400, epoch: 2 | loss: 0.0041324
	speed: 0.0164s/iter; left time: 268.0877s
	iters: 1500, epoch: 2 | loss: 0.0034416
	speed: 0.0167s/iter; left time: 271.2032s
	iters: 1600, epoch: 2 | loss: 0.0018106
	speed: 0.0169s/iter; left time: 273.6987s
	iters: 1700, epoch: 2 | loss: 0.0032542
	speed: 0.0171s/iter; left time: 274.3838s
	iters: 1800, epoch: 2 | loss: 0.0016159
	speed: 0.0169s/iter; left time: 269.7547s
	iters: 1900, epoch: 2 | loss: 0.0030551
	speed: 0.0168s/iter; left time: 266.1281s
	iters: 2000, epoch: 2 | loss: 0.0037637
	speed: 0.0168s/iter; left time: 265.6273s
	iters: 2100, epoch: 2 | loss: 0.0038232
	speed: 0.0174s/iter; left time: 273.0258s
	iters: 2200, epoch: 2 | loss: 0.0032236
	speed: 0.0175s/iter; left time: 273.0800s
	iters: 2300, epoch: 2 | loss: 0.0087874
	speed: 0.0170s/iter; left time: 263.5977s
	iters: 2400, epoch: 2 | loss: 0.0043239
	speed: 0.0167s/iter; left time: 256.5650s
	iters: 2500, epoch: 2 | loss: 0.0016603
	speed: 0.0168s/iter; left time: 256.0612s
	iters: 2600, epoch: 2 | loss: 0.0028264
	speed: 0.0169s/iter; left time: 256.2347s
	iters: 2700, epoch: 2 | loss: 0.0027379
	speed: 0.0167s/iter; left time: 252.0663s
	iters: 2800, epoch: 2 | loss: 0.0035976
	speed: 0.0173s/iter; left time: 259.4801s
	iters: 2900, epoch: 2 | loss: 0.0020378
	speed: 0.0173s/iter; left time: 257.0843s
	iters: 3000, epoch: 2 | loss: 0.0044180
	speed: 0.0171s/iter; left time: 252.4189s
	iters: 3100, epoch: 2 | loss: 0.0022549
	speed: 0.0167s/iter; left time: 244.7386s
	iters: 3200, epoch: 2 | loss: 0.0022293
	speed: 0.0170s/iter; left time: 248.2464s
	iters: 3300, epoch: 2 | loss: 0.0030011
	speed: 0.0170s/iter; left time: 245.5173s
	iters: 3400, epoch: 2 | loss: 0.0028117
	speed: 0.0169s/iter; left time: 242.9411s
	iters: 3500, epoch: 2 | loss: 0.0027756
	speed: 0.0170s/iter; left time: 242.6658s
	iters: 3600, epoch: 2 | loss: 0.0047705
	speed: 0.0167s/iter; left time: 236.5654s
	iters: 3700, epoch: 2 | loss: 0.0036150
	speed: 0.0165s/iter; left time: 232.0884s
	iters: 3800, epoch: 2 | loss: 0.0028573
	speed: 0.0165s/iter; left time: 229.9305s
	iters: 3900, epoch: 2 | loss: 0.0053140
	speed: 0.0170s/iter; left time: 235.8157s
	iters: 4000, epoch: 2 | loss: 0.0068915
	speed: 0.0168s/iter; left time: 231.4898s
	iters: 4100, epoch: 2 | loss: 0.0028606
	speed: 0.0171s/iter; left time: 234.1839s
	iters: 4200, epoch: 2 | loss: 0.0043636
	speed: 0.0171s/iter; left time: 232.2273s
	iters: 4300, epoch: 2 | loss: 0.0025352
	speed: 0.0168s/iter; left time: 226.0338s
	iters: 4400, epoch: 2 | loss: 0.0025574
	speed: 0.0169s/iter; left time: 226.4295s
Epoch: 2 cost time: 74.98835563659668
Epoch: 2, Steps: 4441 | Train Loss: 0.0032773 Vali Loss: 0.0016119 Test Loss: 0.0026150
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0020761
	speed: 2.8053s/iter; left time: 37096.6588s
	iters: 200, epoch: 3 | loss: 0.0023119
	speed: 0.0171s/iter; left time: 224.4344s
	iters: 300, epoch: 3 | loss: 0.0043601
	speed: 0.0173s/iter; left time: 225.4416s
	iters: 400, epoch: 3 | loss: 0.0017922
	speed: 0.0225s/iter; left time: 291.2380s
	iters: 500, epoch: 3 | loss: 0.0035300
	speed: 0.0179s/iter; left time: 229.3141s
	iters: 600, epoch: 3 | loss: 0.0017461
	speed: 0.0165s/iter; left time: 209.8012s
	iters: 700, epoch: 3 | loss: 0.0021129
	speed: 0.0166s/iter; left time: 210.1456s
	iters: 800, epoch: 3 | loss: 0.0049491
	speed: 0.0164s/iter; left time: 205.1043s
	iters: 900, epoch: 3 | loss: 0.0021776
	speed: 0.0165s/iter; left time: 205.3527s
	iters: 1000, epoch: 3 | loss: 0.0027167
	speed: 0.0171s/iter; left time: 210.6345s
	iters: 1100, epoch: 3 | loss: 0.0019267
	speed: 0.0167s/iter; left time: 204.6922s
	iters: 1200, epoch: 3 | loss: 0.0031481
	speed: 0.0167s/iter; left time: 202.0390s
	iters: 1300, epoch: 3 | loss: 0.0031296
	speed: 0.0171s/iter; left time: 205.0291s
	iters: 1400, epoch: 3 | loss: 0.0018758
	speed: 0.0167s/iter; left time: 199.2585s
	iters: 1500, epoch: 3 | loss: 0.0022390
	speed: 0.0168s/iter; left time: 198.7958s
	iters: 1600, epoch: 3 | loss: 0.0043848
	speed: 0.0170s/iter; left time: 199.1477s
	iters: 1700, epoch: 3 | loss: 0.0027627
	speed: 0.0167s/iter; left time: 194.3759s
	iters: 1800, epoch: 3 | loss: 0.0019518
	speed: 0.0171s/iter; left time: 196.9732s
	iters: 1900, epoch: 3 | loss: 0.0078570
	speed: 0.0169s/iter; left time: 193.4190s
	iters: 2000, epoch: 3 | loss: 0.0063232
	speed: 0.0169s/iter; left time: 191.1354s
	iters: 2100, epoch: 3 | loss: 0.0028924
	speed: 0.0170s/iter; left time: 190.9706s
	iters: 2200, epoch: 3 | loss: 0.0013016
	speed: 0.0168s/iter; left time: 186.3334s
	iters: 2300, epoch: 3 | loss: 0.0015142
	speed: 0.0167s/iter; left time: 183.7204s
	iters: 2400, epoch: 3 | loss: 0.0020465
	speed: 0.0166s/iter; left time: 181.3009s
	iters: 2500, epoch: 3 | loss: 0.0034577
	speed: 0.0171s/iter; left time: 184.5538s
	iters: 2600, epoch: 3 | loss: 0.0019037
	speed: 0.0169s/iter; left time: 181.4190s
	iters: 2700, epoch: 3 | loss: 0.0034786
	speed: 0.0165s/iter; left time: 175.1112s
	iters: 2800, epoch: 3 | loss: 0.0032432
	speed: 0.0165s/iter; left time: 173.8168s
	iters: 2900, epoch: 3 | loss: 0.0015676
	speed: 0.0170s/iter; left time: 176.9638s
	iters: 3000, epoch: 3 | loss: 0.0018279
	speed: 0.0170s/iter; left time: 175.2758s
	iters: 3100, epoch: 3 | loss: 0.0036406
	speed: 0.0168s/iter; left time: 172.0134s
	iters: 3200, epoch: 3 | loss: 0.0017098
	speed: 0.0172s/iter; left time: 173.7379s
	iters: 3300, epoch: 3 | loss: 0.0036932
	speed: 0.0170s/iter; left time: 170.8644s
	iters: 3400, epoch: 3 | loss: 0.0021573
	speed: 0.0167s/iter; left time: 166.2097s
	iters: 3500, epoch: 3 | loss: 0.0017696
	speed: 0.0168s/iter; left time: 165.3065s
	iters: 3600, epoch: 3 | loss: 0.0020141
	speed: 0.0168s/iter; left time: 163.0641s
	iters: 3700, epoch: 3 | loss: 0.0031002
	speed: 0.0167s/iter; left time: 160.4089s
	iters: 3800, epoch: 3 | loss: 0.0039528
	speed: 0.0168s/iter; left time: 159.6226s
	iters: 3900, epoch: 3 | loss: 0.0025389
	speed: 0.0171s/iter; left time: 160.7357s
	iters: 4000, epoch: 3 | loss: 0.0019554
	speed: 0.0170s/iter; left time: 158.6248s
	iters: 4100, epoch: 3 | loss: 0.0016605
	speed: 0.0169s/iter; left time: 155.8019s
	iters: 4200, epoch: 3 | loss: 0.0027577
	speed: 0.0168s/iter; left time: 153.1757s
	iters: 4300, epoch: 3 | loss: 0.0038912
	speed: 0.0169s/iter; left time: 152.4962s
	iters: 4400, epoch: 3 | loss: 0.0016331
	speed: 0.0174s/iter; left time: 155.0686s
Epoch: 3 cost time: 75.77626967430115
Epoch: 3, Steps: 4441 | Train Loss: 0.0027597 Vali Loss: 0.0015775 Test Loss: 0.0024512
Validation loss decreased (0.001605 --> 0.001577).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0015230
	speed: 2.8173s/iter; left time: 24744.2119s
	iters: 200, epoch: 4 | loss: 0.0018635
	speed: 0.0170s/iter; left time: 147.6701s
	iters: 300, epoch: 4 | loss: 0.0019542
	speed: 0.0168s/iter; left time: 143.9223s
	iters: 400, epoch: 4 | loss: 0.0042419
	speed: 0.0167s/iter; left time: 141.9712s
	iters: 500, epoch: 4 | loss: 0.0011655
	speed: 0.0167s/iter; left time: 140.0509s
	iters: 600, epoch: 4 | loss: 0.0018384
	speed: 0.0167s/iter; left time: 138.2544s
	iters: 700, epoch: 4 | loss: 0.0011722
	speed: 0.0170s/iter; left time: 138.7040s
	iters: 800, epoch: 4 | loss: 0.0024621
	speed: 0.0171s/iter; left time: 138.6165s
	iters: 900, epoch: 4 | loss: 0.0016306
	speed: 0.0174s/iter; left time: 138.9956s
	iters: 1000, epoch: 4 | loss: 0.0020490
	speed: 0.0172s/iter; left time: 135.3772s
	iters: 1100, epoch: 4 | loss: 0.0030087
	speed: 0.0168s/iter; left time: 130.4541s
	iters: 1200, epoch: 4 | loss: 0.0022798
	speed: 0.0162s/iter; left time: 124.4395s
	iters: 1300, epoch: 4 | loss: 0.0020031
	speed: 0.0167s/iter; left time: 126.5226s
	iters: 1400, epoch: 4 | loss: 0.0016965
	speed: 0.0171s/iter; left time: 128.1503s
	iters: 1500, epoch: 4 | loss: 0.0026341
	speed: 0.0166s/iter; left time: 122.3056s
	iters: 1600, epoch: 4 | loss: 0.0018394
	speed: 0.0169s/iter; left time: 123.3656s
	iters: 1700, epoch: 4 | loss: 0.0025674
	speed: 0.0170s/iter; left time: 122.2219s
	iters: 1800, epoch: 4 | loss: 0.0029976
	speed: 0.0169s/iter; left time: 119.5378s
	iters: 1900, epoch: 4 | loss: 0.0019835
	speed: 0.0171s/iter; left time: 119.3847s
	iters: 2000, epoch: 4 | loss: 0.0034490
	speed: 0.0170s/iter; left time: 117.1587s
	iters: 2100, epoch: 4 | loss: 0.0018694
	speed: 0.0166s/iter; left time: 112.8822s
	iters: 2200, epoch: 4 | loss: 0.0011516
	speed: 0.0170s/iter; left time: 113.7635s
	iters: 2300, epoch: 4 | loss: 0.0012056
	speed: 0.0167s/iter; left time: 109.6692s
	iters: 2400, epoch: 4 | loss: 0.0029247
	speed: 0.0171s/iter; left time: 110.9879s
	iters: 2500, epoch: 4 | loss: 0.0016717
	speed: 0.0169s/iter; left time: 107.9989s
	iters: 2600, epoch: 4 | loss: 0.0016575
	speed: 0.0168s/iter; left time: 105.3009s
	iters: 2700, epoch: 4 | loss: 0.0014973
	speed: 0.0168s/iter; left time: 104.1288s
	iters: 2800, epoch: 4 | loss: 0.0024565
	speed: 0.0171s/iter; left time: 103.7174s
	iters: 2900, epoch: 4 | loss: 0.0022461
	speed: 0.0167s/iter; left time: 99.9480s
	iters: 3000, epoch: 4 | loss: 0.0017953
	speed: 0.0170s/iter; left time: 99.7501s
	iters: 3100, epoch: 4 | loss: 0.0009717
	speed: 0.0172s/iter; left time: 99.3418s
	iters: 3200, epoch: 4 | loss: 0.0018639
	speed: 0.0170s/iter; left time: 96.8323s
	iters: 3300, epoch: 4 | loss: 0.0022671
	speed: 0.0178s/iter; left time: 99.5459s
	iters: 3400, epoch: 4 | loss: 0.0028781
	speed: 0.0177s/iter; left time: 96.9053s
	iters: 3500, epoch: 4 | loss: 0.0025164
	speed: 0.0166s/iter; left time: 89.2448s
	iters: 3600, epoch: 4 | loss: 0.0033408
	speed: 0.0167s/iter; left time: 88.4577s
	iters: 3700, epoch: 4 | loss: 0.0025737
	speed: 0.0168s/iter; left time: 86.8427s
	iters: 3800, epoch: 4 | loss: 0.0015617
	speed: 0.0171s/iter; left time: 86.7299s
	iters: 3900, epoch: 4 | loss: 0.0021416
	speed: 0.0172s/iter; left time: 85.6250s
	iters: 4000, epoch: 4 | loss: 0.0020981
	speed: 0.0166s/iter; left time: 81.1096s
	iters: 4100, epoch: 4 | loss: 0.0010509
	speed: 0.0163s/iter; left time: 78.1208s
	iters: 4200, epoch: 4 | loss: 0.0018723
	speed: 0.0169s/iter; left time: 79.1389s
	iters: 4300, epoch: 4 | loss: 0.0013870
	speed: 0.0173s/iter; left time: 79.1223s
	iters: 4400, epoch: 4 | loss: 0.0021538
	speed: 0.0170s/iter; left time: 76.2718s
Epoch: 4 cost time: 75.3266384601593
Epoch: 4, Steps: 4441 | Train Loss: 0.0023971 Vali Loss: 0.0015585 Test Loss: 0.0024551
Validation loss decreased (0.001577 --> 0.001558).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0019513
	speed: 2.8219s/iter; left time: 12252.5649s
	iters: 200, epoch: 5 | loss: 0.0021608
	speed: 0.0165s/iter; left time: 69.7895s
	iters: 300, epoch: 5 | loss: 0.0012706
	speed: 0.0168s/iter; left time: 69.5597s
	iters: 400, epoch: 5 | loss: 0.0025057
	speed: 0.0168s/iter; left time: 67.9546s
	iters: 500, epoch: 5 | loss: 0.0017657
	speed: 0.0171s/iter; left time: 67.3807s
	iters: 600, epoch: 5 | loss: 0.0020606
	speed: 0.0169s/iter; left time: 65.1189s
	iters: 700, epoch: 5 | loss: 0.0036030
	speed: 0.0165s/iter; left time: 61.6996s
	iters: 800, epoch: 5 | loss: 0.0013390
	speed: 0.0167s/iter; left time: 60.9499s
	iters: 900, epoch: 5 | loss: 0.0020691
	speed: 0.0175s/iter; left time: 61.8619s
	iters: 1000, epoch: 5 | loss: 0.0025970
	speed: 0.0167s/iter; left time: 57.5674s
	iters: 1100, epoch: 5 | loss: 0.0028815
	speed: 0.0166s/iter; left time: 55.3228s
	iters: 1200, epoch: 5 | loss: 0.0021907
	speed: 0.0169s/iter; left time: 54.7617s
	iters: 1300, epoch: 5 | loss: 0.0012407
	speed: 0.0168s/iter; left time: 52.7775s
	iters: 1400, epoch: 5 | loss: 0.0013811
	speed: 0.0170s/iter; left time: 51.8273s
	iters: 1500, epoch: 5 | loss: 0.0052935
	speed: 0.0168s/iter; left time: 49.2795s
	iters: 1600, epoch: 5 | loss: 0.0014919
	speed: 0.0169s/iter; left time: 47.9992s
	iters: 1700, epoch: 5 | loss: 0.0011735
	speed: 0.0171s/iter; left time: 46.7697s
	iters: 1800, epoch: 5 | loss: 0.0012806
	speed: 0.0172s/iter; left time: 45.3696s
	iters: 1900, epoch: 5 | loss: 0.0022630
	speed: 0.0168s/iter; left time: 42.6408s
	iters: 2000, epoch: 5 | loss: 0.0021172
	speed: 0.0168s/iter; left time: 41.0398s
	iters: 2100, epoch: 5 | loss: 0.0013461
	speed: 0.0169s/iter; left time: 39.4869s
	iters: 2200, epoch: 5 | loss: 0.0019148
	speed: 0.0165s/iter; left time: 37.1036s
	iters: 2300, epoch: 5 | loss: 0.0035703
	speed: 0.0170s/iter; left time: 36.4770s
	iters: 2400, epoch: 5 | loss: 0.0012887
	speed: 0.0173s/iter; left time: 35.3790s
	iters: 2500, epoch: 5 | loss: 0.0067550
	speed: 0.0173s/iter; left time: 33.5008s
	iters: 2600, epoch: 5 | loss: 0.0036701
	speed: 0.0169s/iter; left time: 31.1679s
	iters: 2700, epoch: 5 | loss: 0.0047299
	speed: 0.0170s/iter; left time: 29.6965s
	iters: 2800, epoch: 5 | loss: 0.0018895
	speed: 0.0171s/iter; left time: 28.0852s
	iters: 2900, epoch: 5 | loss: 0.0031105
	speed: 0.0164s/iter; left time: 25.2299s
	iters: 3000, epoch: 5 | loss: 0.0014258
	speed: 0.0162s/iter; left time: 23.3912s
	iters: 3100, epoch: 5 | loss: 0.0030769
	speed: 0.0171s/iter; left time: 22.9123s
	iters: 3200, epoch: 5 | loss: 0.0031708
	speed: 0.0172s/iter; left time: 21.3679s
	iters: 3300, epoch: 5 | loss: 0.0031027
	speed: 0.0165s/iter; left time: 18.8677s
	iters: 3400, epoch: 5 | loss: 0.0019720
	speed: 0.0162s/iter; left time: 16.9124s
	iters: 3500, epoch: 5 | loss: 0.0013863
	speed: 0.0168s/iter; left time: 15.8692s
	iters: 3600, epoch: 5 | loss: 0.0013813
	speed: 0.0169s/iter; left time: 14.2489s
	iters: 3700, epoch: 5 | loss: 0.0015915
	speed: 0.0163s/iter; left time: 12.0811s
	iters: 3800, epoch: 5 | loss: 0.0019716
	speed: 0.0167s/iter; left time: 10.7102s
	iters: 3900, epoch: 5 | loss: 0.0025383
	speed: 0.0169s/iter; left time: 9.1864s
	iters: 4000, epoch: 5 | loss: 0.0017152
	speed: 0.0165s/iter; left time: 7.3144s
	iters: 4100, epoch: 5 | loss: 0.0036243
	speed: 0.0167s/iter; left time: 5.7143s
	iters: 4200, epoch: 5 | loss: 0.0032341
	speed: 0.0170s/iter; left time: 4.1239s
	iters: 4300, epoch: 5 | loss: 0.0021709
	speed: 0.0164s/iter; left time: 2.3297s
	iters: 4400, epoch: 5 | loss: 0.0024995
	speed: 0.0167s/iter; left time: 0.7001s
Epoch: 5 cost time: 74.91829895973206
Epoch: 5, Steps: 4441 | Train Loss: 0.0022058 Vali Loss: 0.0015792 Test Loss: 0.0025203
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
>>>>>>>testing : test_iTransformer_custom_MS_ft96_sl48_ll24_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40617
test shape: (40617, 1, 24, 1) (40617, 1, 24, 1)
test shape: (40617, 24, 1) (40617, 24, 1)
mse:0.002455091802403331, mae:0.03127439320087433, rmse:0.049548882991075516, mape:0.19660384953022003, mspe:5.034934043884277
